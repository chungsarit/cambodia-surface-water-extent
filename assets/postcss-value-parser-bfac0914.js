var x="(".charCodeAt(0),k=")".charCodeAt(0),y="'".charCodeAt(0),m='"'.charCodeAt(0),b="\\".charCodeAt(0),g="/".charCodeAt(0),I=",".charCodeAt(0),P=":".charCodeAt(0),$="*".charCodeAt(0),S=function(i){for(var n=[],r=i,e,o,l,t,u,c,f,s=0,a=r.charCodeAt(s),O=r.length,d=[{nodes:n}],v=0,A,p="",C="",w="";s<O;)if(a<=32){e=s;do e+=1,a=r.charCodeAt(e);while(a<=32);t=r.slice(s,e),l=n[n.length-1],a===k&&v?w=t:l&&l.type==="div"?l.after=t:a===I||a===P||a===g&&r.charCodeAt(e+1)!==$?C=t:n.push({type:"space",sourceIndex:s,value:t}),s=e}else if(a===y||a===m){e=s,o=a===y?"'":'"',t={type:"string",sourceIndex:s,quote:o};do if(u=!1,e=r.indexOf(o,e+1),~e)for(c=e;r.charCodeAt(c-1)===b;)c-=1,u=!u;else r+=o,e=r.length-1,t.unclosed=!0;while(u);t.value=r.slice(s+1,e),n.push(t),s=e+1,a=r.charCodeAt(s)}else if(a===g&&r.charCodeAt(s+1)===$)t={type:"comment",sourceIndex:s},e=r.indexOf("*/",s),e===-1&&(t.unclosed=!0,e=r.length),t.value=r.slice(s+2,e),n.push(t),s=e+2,a=r.charCodeAt(s);else if(a===g||a===I||a===P)t=r[s],n.push({type:"div",sourceIndex:s-C.length,value:t,before:C,after:""}),C="",s+=1,a=r.charCodeAt(s);else if(x===a){e=s;do e+=1,a=r.charCodeAt(e);while(a<=32);if(t={type:"function",sourceIndex:s-p.length,value:p,before:r.slice(s+1,e)},s=e,p==="url"&&a!==y&&a!==m){e-=1;do if(u=!1,e=r.indexOf(")",e+1),~e)for(c=e;r.charCodeAt(c-1)===b;)c-=1,u=!u;else r+=")",e=r.length-1,t.unclosed=!0;while(u);f=e;do f-=1,a=r.charCodeAt(f);while(a<=32);s!==f+1?t.nodes=[{type:"word",sourceIndex:s,value:r.slice(s,f+1)}]:t.nodes=[],t.unclosed&&f+1!==e?(t.after="",t.nodes.push({type:"space",sourceIndex:f+1,value:r.slice(f+1,e)})):t.after=r.slice(f+1,e),s=e+1,a=r.charCodeAt(s),n.push(t)}else v+=1,t.after="",n.push(t),d.push(t),n=t.nodes=[],A=t;p=""}else if(k===a&&v)s+=1,a=r.charCodeAt(s),A.after=w,w="",v-=1,d.pop(),A=d[v],n=A.nodes;else{e=s;do a===b&&(e+=1),e+=1,a=r.charCodeAt(e);while(e<O&&!(a<=32||a===y||a===m||a===I||a===P||a===g||a===x||a===k&&v));t=r.slice(s,e),x===a?p=t:n.push({type:"word",sourceIndex:s,value:t}),s=e}for(s=d.length-1;s;s-=1)d[s].unclosed=!0;return d[0].nodes},V=function i(n,r,e){var o,l,t,u;for(o=0,l=n.length;o<l;o+=1)t=n[o],e||(u=r(t,o,n)),u!==!1&&t.type==="function"&&Array.isArray(t.nodes)&&i(t.nodes,r,e),e&&r(t,o,n)};function E(i,n){var r=i.type,e=i.value,o,l;return n&&(l=n(i))!==void 0?l:r==="word"||r==="space"?e:r==="string"?(o=i.quote||"",o+e+(i.unclosed?"":o)):r==="comment"?"/*"+e+(i.unclosed?"":"*/"):r==="div"?(i.before||"")+e+(i.after||""):Array.isArray(i.nodes)?(o=Q(i.nodes),r!=="function"?o:e+"("+(i.before||"")+o+(i.after||"")+(i.unclosed?"":")")):e}function Q(i,n){var r,e;if(Array.isArray(i)){for(r="",e=i.length-1;~e;e-=1)r=E(i[e],n)+r;return r}return E(i,n)}var X=Q,q,N;function _(){if(N)return q;N=1;var i="-".charCodeAt(0),n="+".charCodeAt(0),r=".".charCodeAt(0),e="e".charCodeAt(0),o="E".charCodeAt(0);return q=function(l){for(var t=0,u=l.length,c=!1,f=-1,s=!1,a;t<u;){if(a=l.charCodeAt(t),a>=48&&a<=57)s=!0;else if(a===e||a===o){if(f>-1)break;f=t}else if(a===r){if(c)break;c=!0}else if(a===n||a===i){if(t!==0)break}else break;t+=1}return f+1===t&&t--,s?{number:l.slice(0,t),unit:l.slice(t)}:!1},q}var j=S,R=V,U=X;function h(i){return this instanceof h?(this.nodes=j(i),this):new h(i)}h.prototype.toString=function(){return Array.isArray(this.nodes)?U(this.nodes):""};h.prototype.walk=function(i,n){return R(this.nodes,i,n),this};h.unit=_();h.walk=R;h.stringify=U;var z=h;export{z as l};

import{a as X,j as e,r as c}from"./react-18892649.js";import{c as xe}from"./react-dom-81b76a28.js";import{B as l,T as h,C as pe,c as he,a as L,I as Q,d as fe,b as ge,e as be,f as je,g as ye,F as Ce,h as we,i as ee,j as Se,k as te,l as ke,m as ve,n as ze,o as Pe,s as S,u as k,p as v,q as Me,r as Ae,t as De,v as Fe,D as Te,w as Ie,S as re,x as Oe,y as Le,z as $e,A as Ee,E as _e,G as Be,H as G,J as Re,L as C,K as Ne,M as Ke}from"./@mui-6ecc9feb.js";import{L as Ge}from"./leaflet-19bf3ea3.js";import{S as We}from"./react-color-b94aa2a8.js";import"./tinycolor2-ea5bcbb6.js";import{P as I,G as He,M as Je,T as W}from"./react-leaflet-8b74bc0a.js";import"./d3-zoom-4d2927c0.js";import{R as Ze,B as qe,C as Ue,X as Ye,Y as Ve,T as Xe,a as H}from"./recharts-d88d6920.js";import{c as Qe}from"./d3-fetch-25ec0933.js";import{C as et,a as tt,L as rt,B as st,p as at,b as nt}from"./chart.js-db41f96f.js";import{f as J}from"./@faker-js-4a193f06.js";import"./@babel-4ef42ede.js";import"./scheduler-765c72db.js";import"./@emotion-b8612e06.js";import"./hoist-non-react-statics-23d96a9a.js";import"./react-is-e8e5dbb3.js";import"./stylis-79144faa.js";import"./clsx-1229b3e0.js";import"./react-transition-group-b40fb521.js";import"./@popperjs-f3391c26.js";import"./reactcss-dd7d3e30.js";import"./lodash-7e8ffe3d.js";import"./prop-types-ad9d6448.js";import"./lodash-es-0a95e7b3.js";import"./material-colors-b3b3c86a.js";import"./@icons-3cdbe9c6.js";import"./@react-leaflet-45de2822.js";import"./classnames-82acb64e.js";import"./react-resize-detector-16051816.js";import"./react-smooth-3a0295d1.js";import"./fast-equals-a0711cdd.js";import"./victory-vendor-59898c6b.js";import"./d3-scale-77639e02.js";import"./internmap-7949acc8.js";import"./d3-array-7d9b19f9.js";import"./d3-time-format-aa787c71.js";import"./d3-time-9ce187c0.js";import"./d3-interpolate-d7dc1352.js";import"./d3-color-6502c434.js";import"./d3-format-ffdb8652.js";import"./recharts-scale-170b47f7.js";import"./decimal.js-light-6fe16ef2.js";import"./d3-shape-9e788a4f.js";import"./d3-path-41c4cb36.js";import"./reduce-css-calc-c7bcf62f.js";import"./postcss-value-parser-bfac0914.js";import"./css-unit-converter-9e08bb2c.js";import"./eventemitter3-0cc898a2.js";import"./d3-dsv-3ac754ad.js";import"./@kurkle-b1b89bbc.js";(function(){const r=document.createElement("link").relList;if(r&&r.supports&&r.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))a(n);new MutationObserver(n=>{for(const o of n)if(o.type==="childList")for(const i of o.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&a(i)}).observe(document,{childList:!0,subtree:!0});function s(n){const o={};return n.integrity&&(o.integrity=n.integrity),n.referrerPolicy&&(o.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?o.credentials="include":n.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function a(n){if(n.ep)return;n.ep=!0;const o=s(n);fetch(n.href,o)}})();class ot extends X.Component{constructor(r){super(r),this.state={hasError:!1}}static getDerivedStateFromError(r){return{hasError:!0}}componentDidCatch(r,s){console.error=()=>{}}render(){return this.state.hasError?e.jsx(e.Fragment,{children:e.jsx("h1",{children:"Something went wrong."})}):this.props.children}}function it(t){return e.jsx(pe,{variant:"indeterminate",disableShrink:!0,sx:{color:r=>r.palette.mode==="light"?"#1a90ff":"#308fe8",animationDuration:"1000ms",[`& .${he.circle}`]:{strokeLinecap:"round"}},size:60,thickness:4,...t})}function lt(){return e.jsxs(l,{sx:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",width:"100vw",height:"100vh",color:"darkgrey"},children:[e.jsx(it,{}),e.jsx(h,{sx:{mt:1},children:"Loading the map ðŸ—ºï¸ ðŸŒŽ"}),e.jsx(h,{sx:{mt:1},children:"Created by CHUNG Sarit"})]})}async function ct(){const t=await fetch("https://flask-api-ee-railway.up.railway.app/getListYearlyTileUrlJRC");if(!t.ok)throw new Error(`HTTP error! status: ${t.status}`);return await t.json()}function dt(){const[t,r]=c.useState(null),[s,a]=c.useState(!1),[n,o]=c.useState(null);return c.useEffect(()=>{a(!0),ct().then(i=>{if(!i)throw new Error("No data");r(i),a(!1)}).catch(i=>{o(i),a(!1)})},[]),{data:t,isLoading:s,error:n}}const se=c.createContext(),g=()=>c.useContext(se),mt=({children:t})=>{const[r,s]=c.useState(2e3),[a,n]=c.useState(1),[o,i]=c.useState("https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png"),[m,d]=c.useState(null),[u,x]=c.useState({"Open Street Map":{url:"https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",attribution:'Map data &copy; <a href="https://www.openstreetmap.org/copyright" target="_blank">OpenStreetMap</a> Contributors',maxZoom:18}}),[f,$]=c.useState("Prey Veng"),[z,E]=c.useState("ADM0");return e.jsx(se.Provider,{value:{map:m,setMap:d,year:r,setYear:s,opacity:a,setOpacity:n,baseMapLayerUrl:o,setBaseMapLayerUrl:i,baseMapLayerConfig:u,setBaseMapLayerConfig:x,selectedProvince:f,setSelectedProvince:$,admLevel:z,setAdmLevel:E},children:t})};function j({children:t,tooltipText:r="",...s}){const{sx:a,...n}=s;return e.jsx(L,{title:r,arrow:!0,children:e.jsx(Q,{sx:{boxShadow:3,width:{xs:"2rem",sm:"2rem"},height:{xs:"2rem",sm:"2rem"},backgroundColor:"white",color:"black","&:hover":{backgroundColor:"#f4f4f4"},border:"1px solid lightgrey",...a},...n,children:t})})}function ut(){const t=[[10.409,102.144],[14.58,107.8]],{map:r}=g(),s=()=>{if(r)r.flyToBounds(t,{padding:[0,0],duration:1});else return};return e.jsx(j,{onClick:s,tooltipText:"Home",children:e.jsx(fe,{})})}function xt(){const{map:t}=g(),r=()=>{t&&t.zoomIn()};return e.jsx(j,{onClick:r,tooltipText:"Zoom In",children:e.jsx(ge,{})})}function pt(){const{map:t}=g(),r=()=>{t&&t.zoomOut()};return e.jsx(j,{onClick:r,tooltipText:"Zoom Out",children:e.jsx(be,{})})}function ht(){const t=document.body,[r,s]=c.useState(!1);c.useEffect(()=>{const n=o=>{(o.key==="F"||o.code==="KeyF")&&a()};return window.addEventListener("keydown",n),()=>{window.removeEventListener("keydown",n)}},[]);const a=()=>{document.fullscreenElement||document.webkitFullscreenElement||document.mozFullScreenElement||document.msFullscreenElement?document.exitFullscreen?(document.exitFullscreen(),s(!1)):document.mozCancelFullScreen?(document.mozCancelFullScreen(),s(!1)):document.webkitExitFullscreen?(document.webkitExitFullscreen(),s(!1)):document.msExitFullscreen&&(document.msExitFullscreen(),s(!1)):t.requestFullscreen?(t.requestFullscreen(),s(!0)):t.mozRequestFullScreen?(t.mozRequestFullScreen(),s(!0)):t.webkitRequestFullscreen?(t.webkitRequestFullscreen(),s(!0)):t.msRequestFullscreen&&(t.msRequestFullscreen(),s(!0))};return e.jsx("div",{children:e.jsx(j,{onClick:a,tooltipText:"Full Screen",children:r?e.jsx(je,{}):e.jsx(ye,{})})})}function ft(){const[t,r]=c.useState(null),s="/cambodia-surface-water-extent/data/geojson/worldRectangular.json";return c.useEffect(()=>{fetch(s).then(a=>a.json()).then(a=>{r(a)}).catch(a=>{console.error("Error fetching GeoJSON data",a)})},[]),e.jsx(e.Fragment,{children:t&&e.jsx(I,{name:"adminLayers",style:{zIndex:150},children:e.jsx(He,{data:t,style:{color:"black",fillOpacity:.4,weight:0}})})})}const gt=({layerWeight:t,setLayerWeight:r})=>e.jsx(ee,{id:"weight-admin-layer",label:"Outline thickness",type:"number",value:t,onChange:s=>{if(s.target.value<.1){r(.1);return}if(s.target.value>10){r(10);return}r(s.target.value)},InputProps:{inputProps:{min:.1,max:10,step:.1}},sx:{"& .MuiInputBase-input":{fontSize:{xs:"0.65rem",sm:"0.75rem"},height:"1rem",padding:"0.25rem",width:"13ch"},".MuiInputLabel-root":{fontSize:{xs:"0.65rem",sm:"0.75rem"}}}}),bt=({layerColor:t,setLayerColor:r})=>{const s=t.slice(5,-1).split(",").map(x=>parseInt(x.trim())),[a,n]=c.useState({r:s[0],g:s[1],b:s[2],a:s[3]}),[o,i]=c.useState(!1),m=()=>{i(!o)},d=()=>{i(!1)},u=x=>{n(x.rgb),r(`rgba(${x.rgb.r}, ${x.rgb.g}, ${x.rgb.b}, ${x.rgb.a})`)};return e.jsxs(l,{onMouseDown:x=>{x.stopPropagation()},children:[e.jsxs(l,{sx:{display:"flex",flexDirection:"row",alignItems:"center",gap:1},children:[e.jsx(L,{title:"Colorize",children:e.jsx(Q,{sx:{p:0},onClick:m,children:e.jsx(Se,{sx:{fontSize:"1rem",color:"black"}})})}),e.jsx(l,{sx:{fontSize:"1rem",width:"2rem",height:"0.2rem",bgcolor:`rgba(${a.r}, ${a.g}, ${a.b}, ${a.a})`,border:"0.1px solid grey"}})]}),o?e.jsx(te,{onClickAway:d,children:e.jsx(l,{sx:{position:"absolute",zIndex:2,right:"0.5rem"},children:e.jsx(We,{color:a,onChange:u,width:"",height:""})})}):null]})},jt=({adminLevel:t,labelName:r,initialCheck:s,color:a="rgba(50, 50, 50, 1)",lineWeight:n=1})=>{const[o,i]=c.useState(s),[m,d]=c.useState(a),[u,x]=c.useState(n),{map:f,admLevel:$,setAdmLevel:z,selectedProvince:E,setSelectedProvince:ae}=g(),[w,_]=c.useState(null);function ne(p,B,R,N){let P,K,M,A;p==="admin0"?(A="/cambodia-surface-water-extent/data/geojson/khm_admbnda_adm0_gov_20181004.json",P=2e4):p==="admin1"&&(A="/cambodia-surface-water-extent/data/geojson/khm_admbnda_adm1_gov_20181004.json",P=3e4),fetch(A).then(y=>y.json()).then(y=>{K=y,f.getPane(p)||(f.createPane(p),f.getPane(p).style.zIndex=P,f.getPane(p).style.pointerEvents="none");function le(b){b.target.setStyle({weight:R*2.5,color:B,dashArray:"",fillOpacity:.1})}function ce(b){M.resetStyle(b.target)}function de(b){f.flyToBounds(b.target.getBounds()),ae(b.target.feature.properties.ADM1_EN),z("ADM1")}function me(b,ue){p==="admin1"&&ue.on({click:de,mouseover:le,mouseout:ce})}M=Ge.geoJSON(K,{pane:p,style:{color:B,weight:R,fillOpacity:0},onEachFeature:me}).addTo(f),N&&N(M)}).catch(y=>{console.error("Error fetching GeoJSON data",y)})}const oe=p=>{i(p)},ie=p=>{oe(p.target.checked)};return c.useEffect(()=>{f&&(o?ne(t,m,u,_):w&&(w.remove(),_(null)))},[o,f]),c.useEffect(()=>{w&&w.setStyle({color:m,weight:u,fillOpacity:0})},[m,u]),e.jsxs(l,{sx:{display:"flex",flexDirection:{xs:"column"},rowGap:{xs:1}},children:[e.jsx(Ce,{control:e.jsx(we,{checked:o,onChange:p=>ie(p),name:t,size:"small",sx:{p:0,pl:1}}),label:r,sx:{"& .MuiTypography-root":{fontSize:{xs:"0.65rem",sm:"0.75rem"}}}}),e.jsxs(l,{sx:{display:"flex",flexDirection:"row",gap:0,justifyContent:"space-between"},children:[e.jsx(gt,{layerWeight:u,setLayerWeight:x}),e.jsx(bt,{layerColor:m,setLayerColor:d})]})]})},yt=()=>{const t={admin0:{labelName:"Country",initialCheck:!0,color:"rgba(255, 255, 255, 1)",lineWeight:3},admin1:{labelName:"Capital/Provinces",initialCheck:!0,color:"rgba(50, 50, 50, 1)",lineWeight:1}};return e.jsx(l,{sx:{display:"flex",flexDirection:"column",rowGap:1,width:"100%"},children:Object.keys(t).map(r=>e.jsx(jt,{adminLevel:r,labelName:t[r].labelName,initialCheck:t[r].initialCheck,color:t[r].color,lineWeight:t[r].lineWeight},r))})},D={"Open Street Map":{url:"https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",attribution:'Map data &copy; <a href="https://www.openstreetmap.org/copyright" target="_blank">OpenStreetMap</a> Contributors',maxZoom:18},"Carto Dark":{url:"https://{s}.basemaps.cartocdn.com/dark_all/{z}/{x}/{y}{r}.png",attribution:'Map data &copy; <a href="https://carto.com/attributions" target="_blank">CARTO</a>',maxZoom:19},"Google Satellite":{url:"https://mt1.google.com/vt/lyrs=y&x={x}&y={y}&z={z}",attribution:'Map data &copy <a href="https://www.google.at/permissions/geoguidelines/attr-guide.html" target="_blank">Google</a>',maxZoom:18},"Google Terrain":{url:"https://mt1.google.com/vt/lyrs=p&x={x}&y={y}&z={z}",attribution:'Map data &copy <a href="https://www.google.at/permissions/geoguidelines/attr-guide.html" target="_blank">Google</a>',maxZoom:18}},Ct=["Open Street Map","Google Satellite","Carto Dark","Google Terrain"];function wt(){const[t,r]=c.useState(!1),s=()=>{r(!t)},a=()=>{r(!1)},{baseMapLayerConfig:n,setBaseMapLayerConfig:o}=g(),i=d=>{o({[d]:{url:D[d].url,attribution:D[d].attribution,maxZoom:D[d].maxZoom}})},m=d=>e.jsx(ve,{sx:{cursor:"pointer"},onClick:()=>i(d),children:e.jsxs(ze,{children:[e.jsx(Pe,{sx:{aspectRatio:"2/1.5",width:{xs:"5rem"}},image:`/cambodia-surface-water-extent/data/img/${d}.png`,title:d}),e.jsx(h,{sx:{fontSize:{xs:"0.55rem",sm:"0.65rem"},textAlign:"center",lineHeight:"0.9rem"},children:d})]})},d);return e.jsx(te,{onClickAway:a,children:e.jsxs(l,{sx:{display:"flex",flexDirection:"column",alignItems:"flex-end"},children:[e.jsx(j,{onClick:s,tooltipText:"Basemap and Admin layers",children:e.jsx(ke,{})}),e.jsxs(l,{sx:{backgroundColor:"white",borderRadius:"0.5rem",display:t?"flex":"none",mr:"0.5rem",fontSize:{xs:"0.65rem",sm:"0.75rem"},fontWeight:"bold",flexDirection:"column",alignItems:"center",p:1,gap:1},children:["Basemap",e.jsx(l,{sx:{display:"flex",flexWrap:"wrap",alignItems:"center",width:{xs:"10.55rem"},gap:1},children:Ct.map(d=>m(d))}),"Administrative boundaries",e.jsx(yt,{})]})]})})}function St({eeImageUrls:t}){const{map:r,setMap:s,year:a,setYear:n,opacity:o,setOpacity:i,baseMapLayerConfig:m,setBaseMapLayerConfig:d}=g();return e.jsx(e.Fragment,{children:t&&e.jsxs(l,{sx:{height:"100%",width:"100%"},children:[e.jsxs(l,{sx:{position:"absolute",zIndex:1e3,display:"flex",flexDirection:"column",gap:"0.1rem",top:{xs:"calc(3rem)",md:"0.5rem"},right:{xs:"calc(0.5rem)"},alignItems:"flex-end"},children:[e.jsx(ut,{}),e.jsx(xt,{}),e.jsx(pt,{}),e.jsx(ht,{}),e.jsx(wt,{})]}),e.jsxs(Je,{ref:s,center:[12.5657,104.991],zoomControl:!1,zoom:7.5,maxZoom:18,scrollWheelZoom:!0,style:{height:"100%",width:"100%",padding:0,margin:0},zoomDelta:.25,zoomSnap:.25,children:[e.jsx(I,{name:"baseMapLayers",style:{zIndex:0},children:e.jsx(W,{url:Object.values(m)[0].url,attribution:Object.values(m)[0].attribution,maxZoom:Object.values(m)[0].maxZoom,opacity:1},Object.keys(m)[0])}),e.jsx(I,{name:"JRC_flood_extents",style:{zIndex:100},children:e.jsx(W,{url:t[a],opacity:o},a)}),e.jsx(ft,{})]})]})})}const kt=({open:t,anchorlocation:r})=>e.jsx(l,{sx:{display:"flex",alignItems:"center",textAlign:"center",justifyContent:"center",height:"2rem",fontSize:{xs:"1rem"},fontWeight:"bold",bgcolor:"rgba(255,255,255, 0.8)",borderRadius:"3.5rem",boxShadow:r==="left"&&t?0:3,position:{xs:"fixed"},top:"0.5rem",zIndex:1e4,width:{xs:"calc(100vw)",md:"calc(400px)"}},children:"Cambodia-Surface Water Extent"}),vt=S(l,{shouldForwardProp:t=>t!=="open"})(({theme:t,open:r,drawerheightorwidth:s,anchorlocation:a})=>({display:"flex",flexGrow:1,marginBottom:a==="bottom"&&r?`${s}`:0,marginLeft:a==="left"&&r?`${s}`:0,transition:t.transitions.create(["marginBottom","marginLeft"],{easing:r?t.transitions.easing.easeOut:t.transitions.easing.sharp,duration:r?t.transitions.duration.enteringScreen:t.transitions.duration.leavingScreen})})),zt=S(j,{shouldForwardProp:t=>t!=="open"})(({theme:t,open:r,drawerheightorwidth:s,anchorlocation:a})=>({position:"absolute",zIndex:10001,display:"flex",flexDirection:"column-reverse",bottom:a==="bottom"?r?`${s}`:0:"auto",left:a==="left"?r?`calc(${s} - 2.5rem)`:0:"calc(0.5rem)",height:a==="bottom"?"auto":"100vh",top:a==="left"?"calc(0.5rem)":"auto",transition:t.transitions.create(["bottom","left"],{easing:r?t.transitions.easing.easeOut:t.transitions.easing.sharp,duration:r?t.transitions.duration.enteringScreen:t.transitions.duration.leavingScreen})}));function Pt({contentChildren:t,drawerChildren:r}){const{map:s,setMap:a}=g(),[n,o]=c.useState(!1),i=k(),m=v(i.breakpoints.down("md")),d=m?"18rem":"25rem",u=m?"bottom":"left",x=()=>{o(!n)};return c.useEffect(()=>{s&&s.invalidateSize({animate:!1})},[n,s]),c.useEffect(()=>{o(!0)},[]),e.jsxs(e.Fragment,{children:[e.jsx(kt,{open:n,anchorlocation:u}),e.jsxs(zt,{open:n,drawerheightorwidth:d,anchorlocation:u,onClick:x,tooltipText:n?"Close drawer":"Open drawer",children:[u==="bottom"&&(n?e.jsx(Me,{}):e.jsx(Ae,{})),u==="left"&&(n?e.jsx(De,{}):e.jsx(Fe,{}))]}),e.jsxs(l,{sx:{display:"flex",height:"100%",width:"100%"},children:[e.jsx(Te,{transitionDuration:{enter:i.transitions.duration.enteringScreen,exit:i.transitions.duration.leavingScreen},sx:{display:"flex",overflow:"auto","& .MuiDrawer-paper":{height:u==="bottom"?d:"calc(100vh)",width:u==="bottom"?"100vw":`calc(${d})`,bgcolor:"rgba(255,255,255, 1)",boxShadow:"none",borderRadius:"none",border:"none"}},variant:"persistent",anchor:u,open:n,children:r}),e.jsx(vt,{open:n,drawerheightorwidth:d,anchorlocation:u,children:t})]})]})}function Z({color:t,label:r}){return e.jsxs(l,{sx:{color:t,display:"flex",flexDirection:"row",gap:1},children:[e.jsx($e,{sx:{fontSize:"medium"}}),e.jsx(h,{sx:{fontSize:{xs:"0.65rem",sm:"0.75rem",textAlign:"left"}},children:r})]})}function Mt({}){return e.jsxs(l,{id:"legend",children:[e.jsx(h,{sx:{fontSize:{xs:"0.65rem",sm:"0.75rem",textAlign:"left"}},children:"Surface water classes"}),e.jsxs(l,{sx:{display:"flex",flexDirection:{xs:"column"},gap:{xs:0}},children:[e.jsx(Z,{color:"#0000ff",label:e.jsxs(e.Fragment,{children:[e.jsx("strong",{children:"Permanent water "}),"(present for 12 months per year)"]})}),e.jsx(Z,{color:"#41b7d8",label:e.jsxs(e.Fragment,{children:[e.jsx("strong",{children:"Seasonal water "}),"(present for less than 12 months per year)"]})})]})]})}function At({opacity:t,setOpacity:r}){const s=(a,n)=>{r(n)};return e.jsxs(l,{sx:{width:"100%",maxWidth:370,display:"flex",justifyContent:"space-around",alignItems:"center",fontSize:{xs:"0.65rem",sm:"0.75rem"},bgcolor:"white"},children:["Opacity",e.jsx(Ie,{size:"small",sx:{opacity:.9}}),e.jsx(re,{size:"small",value:t,min:0,max:1,step:.01,onChange:s,sx:{color:"black",width:{xs:"100%"},maxWidth:{xs:150},"& .MuiSlider-markLabel":{fontSize:{xs:"0.65rem",sm:"0.75rem"},color:"black"}}}),Math.round(t*100),"%"]})}function Dt({year:t,setYear:r,isPlaying:s,setIsPlaying:a,marks:n}){const o=(m,d)=>{r(d),a(!1)},i=()=>{a(!s),t===2021&&r(2e3)};return e.jsxs(l,{sx:{display:"flex",flexDirection:"row",gap:{xs:4,sm:6},width:"100%"},children:[e.jsx(j,{onClick:i,children:s?e.jsx(Oe,{}):e.jsx(Le,{})}),e.jsx(re,{"aria-labelledby":"discrete-slider",valueLabelDisplay:"auto",step:1,marks:n,min:2e3,max:2021,value:t,onChange:o,sx:{"& .MuiSlider-markLabel":{fontSize:{xs:"0.65rem",sm:"0.75rem"},color:"black"}}})]})}function Ft(){const{year:t,setYear:r,opacity:s,setOpacity:a}=g(),[n,o]=c.useState(!1),i=k(),m=v(i.breakpoints.down("sm"));c.useEffect(()=>{let u;return n&&t<2021?u=setInterval(()=>{r(x=>Math.min(x+1,2021))},1500):o(!1),()=>{clearInterval(u)}},[n,t]);const d=[];for(let u=2e3;u<=2021;u++){const x={value:u};m?u%10===0&&(x.label=`${u}`):u%5===0&&(x.label=`${u}`),d.push(x)}return e.jsxs(l,{sx:{display:"flex",flexDirection:"column",justifyContent:{xs:"space-between"},height:"100%",width:"100%",maxWidth:600,alignItems:"center"},children:[e.jsxs(l,{children:[e.jsx(h,{sx:{fontSize:{xs:"0.7rem",sm:"0.8rem"},fontWeight:"bold"},children:"Choose a year to view the surface water extent"}),e.jsxs(h,{sx:{fontSize:{xs:"0.65rem",sm:"0.75rem"}},children:["(Current displayed year: ",e.jsx("span",{style:{fontWeight:"bold"},children:t}),")"]})]}),e.jsx(Dt,{year:t,setYear:r,isPlaying:n,setIsPlaying:o,marks:d}),e.jsx(At,{opacity:s,setOpacity:a}),e.jsx(Mt,{})]})}const Tt=async t=>(await Qe(t)).map(s=>({year:s.year,"Permanent water":parseFloat(s["Permanent water"]),"Seasonal water":parseFloat(s["Seasonal water"]),"No data":parseFloat(s.no_data),"Not water":parseFloat(s.not_water),Total:parseFloat(s["Permanent water"])+parseFloat(s["Seasonal water"])})),q=({children:t,color:r})=>e.jsxs(l,{sx:{display:"flex",alignItems:"center",columnGap:1,color:r},children:[e.jsx(l,{sx:{bgcolor:r,width:"1rem",height:"0.5rem"}}),e.jsx(h,{sx:{fontSize:{xs:"0.65rem",sm:"0.75rem"}},children:t})]}),It=({active:t,payload:r,label:s})=>t&&r&&r.length?e.jsxs(l,{className:"custom-tooltip-barchart",sx:{display:"flex",flexDirection:"column",alignItems:"flex-start",backgroundColor:"rgba(255, 255, 255, 0.85)",color:"black",p:1},children:[e.jsx(h,{sx:{fontSize:{xs:"0.65rem",sm:"0.75rem"}},children:`Year : ${s}`}),e.jsxs(q,{color:"#41b7d8",children:[`${r[1].dataKey} : ${r[1].value}`," kmÂ²"]}),e.jsxs(q,{color:"#0000ff",children:[`${r[0].dataKey} : ${r[0].value}`," kmÂ²"]})]}):null,U=({admLevel:t,admName:r})=>{const s=k(),a=v(s.breakpoints.down("sm")),n=`/cambodia-surface-water-extent/data/csv_waterextent/${t}/${r}.csv`,[o,i]=c.useState([]);return c.useEffect(()=>{Tt(n).then(i)},[t,r]),e.jsx("div",{className:"histogram",style:{height:"100%",width:"100%"},children:e.jsx(Ze,{minHeight:10,width:"100%",height:"100%",children:e.jsxs(qe,{data:o,margin:{top:0,right:0,left:5,bottom:0},fontSize:a?"0.65rem":"0.75rem",barSize:9,children:[e.jsx(Ue,{strokeDasharray:"4 4 1"}),e.jsx(Ye,{dataKey:"year"}),e.jsx(Ve,{label:{value:"Water Area [kmÂ²]",angle:-90,position:"center",dx:-25}}),e.jsx(Xe,{content:e.jsx(It,{})}),e.jsx(H,{dataKey:"Permanent water",fill:"#0000ff",stackId:"a"}),e.jsx(H,{dataKey:"Seasonal water",fill:"#41b7d8",stackId:"a"})]})})})},Ot=["Banteay Meanchey","Battambang","Kampong Cham","Kampong Chhnang","Kampong Speu","Kampong Thom","Kampot","Kandal","Kep","Koh Kong","Kratie","Mondul Kiri","Oddar Meanchey","Pailin","Phnom Penh","Preah Sihanouk","Preah Vihear","Prey Veng","Pursat","Ratanak Kiri","Siemreap","Stung Treng","Svay Rieng","Takeo","Tboung Khmum"],Y=S(Ee)(({theme:t})=>({minHeight:"unset",height:"2rem",textTransform:"capitalize",padding:"0.5rem",fontSize:"0.7rem",[t.breakpoints.up("sm")]:{fontSize:"0.8rem"}}));function Lt(){const{selectedProvince:t,setSelectedProvince:r,admLevel:s,setAdmLevel:a}=g(),n=(i,m)=>{a(m)},o=Ot.map((i,m)=>i);return e.jsxs(l,{sx:{width:"100%",height:"100%"},children:[e.jsx(h,{sx:{fontSize:{xs:"0.7rem",sm:"0.8rem",fontWeight:"bold",height:"1rem"}},children:"Annual time-series of surface water extent"}),e.jsx(l,{sx:{display:"flex",flexDirection:"column",alignItems:"center",height:"calc(100% - 1rem)"},children:e.jsxs(_e,{value:s,children:[e.jsxs(Be,{onChange:n,"aria-label":"tabs-plotting-component",sx:{minHeight:"unset",fontSize:{xs:"0.65rem",sm:"0.75rem",height:"2rem"}},children:[e.jsx(Y,{label:"National level",value:"ADM0"}),e.jsx(Y,{label:"Provincial level",value:"ADM1"})]}),e.jsxs(l,{sx:{width:"100%",mt:2,height:"calc(100% - 3rem)"},children:[e.jsx(G,{value:"ADM0",sx:{p:0,height:"100%"},children:e.jsx(U,{admLevel:"ADM0",admName:"Cambodia"})}),e.jsxs(G,{value:"ADM1",sx:{p:0,height:"100%"},children:[e.jsx(l,{sx:{mt:1,mb:1,height:"2rem"},children:e.jsx(Re,{size:"small",disableClearable:!0,value:t,onChange:(i,m)=>{r(m)},id:"combo-box",options:o,renderInput:i=>e.jsx(ee,{...i,label:"Provinces/Capital (ážáŸážáŸ’áž/ážšáž¶áž‡áž’áž¶áž“áž¸)",InputProps:{...i.InputProps,inputProps:{...i.inputProps,sx:{fontSize:{xs:"0.65rem",sm:"0.75rem"}}}}}),renderOption:(i,m,d)=>e.jsx(h,{...i,sx:{fontSize:{xs:"0.75rem",sm:"0.85rem"}},children:m})})}),e.jsx(l,{sx:{height:"calc(100% - 3rem)"},children:e.jsx(U,{admLevel:"ADM1",admName:t})})]})]})]})})]})}const V=({headText:t="",children:r})=>e.jsxs(l,{children:[e.jsx(h,{sx:{fontSize:{xs:"0.65rem",sm:"0.75rem"},fontWeight:"bold",textAlign:"left"},children:t}),e.jsx(h,{sx:{fontSize:{xs:"0.65rem",sm:"0.75rem"},textAlign:"justify"},children:r})]}),O=()=>e.jsx(C,{href:"https://doi.org/10.1038/nature20584",target:"_blank",rel:"noopener noreferrer",children:"Pekel et al., 2016"});function $t(){const[t,r]=c.useState(!1),s=()=>{r(!1)},a=()=>{r(!0)};return e.jsx(L,{open:t,onClose:s,onOpen:a,sx:{bgcolor:"white"},arrow:!0,title:e.jsxs(l,{sx:{textAlign:"justify",lineHeight:"1rem"},children:["Disclaimer",e.jsx("br",{}),"âœ… This app is provided for informational purposes. The accuracy of the information provided is subject to the accuracy of the source data.",e.jsx("br",{}),"âœ… The boundaries for both the country and provinces used here do not imply official endorsement or acceptance by the United Nations. They were obtained from Humaniarian Data Exchange (",e.jsx(C,{href:"https://data.humdata.org/dataset/cambodia-admin-level-0-international-boundaries",target:"_blank",rel:"noopener noreferrer",children:"HDX"}),") as Shapefile.",e.jsx("br",{}),"âœ… By accessing this website, users agree to take full responsibility for reliance on any site information provided and to hold harmless and waive any and all liability against individuals or entities associated with its development, form and content for any loss, harm or damage suffered as a result of its use.",e.jsx("br",{}),"âœ… More details about the dataset and its limitations can be found in this paper (",e.jsx(O,{}),")."]}),children:e.jsx(C,{component:"button",onClick:()=>{r(!0)},sx:{color:"#727272"},children:"Disclaimer"})})}function Et(){return e.jsxs(l,{sx:{display:"flex",flexDirection:"column",alignItems:"flex-start"},children:[e.jsx(V,{headText:"About the App",children:"The app aims to provide dynamic visualization of surface water extent in Cambodia from 2000 to 2021. Additionally, it offers annual surface water areas calculated at both national and provincial levels."}),e.jsxs(V,{headText:"About the Data",children:["Using the"," ",e.jsx(C,{href:"https://earthengine.google.com/",target:"_blank",rel:"noopener noreferrer",children:"Google Earth Engine"})," ","Python API, the surface water extents have been extracted from the Joint Research Centre (JRC) yearly water classification history dataset (",e.jsx(O,{}),"). This dataset is available at a 30-m spatial resolution from 1984 to 2021. However, due to limited coverage and some gaps in the early history of the Landsat archive prior to 2000, which could compromise consistent assessment of surface water dynamics, only data from 2000 to 2021 is presented here. More details about the dataset and its limitations can be found in this paper (",e.jsx(O,{}),")"]})]})}et.register(tt,rt,st,at,nt);const F=["January","February","March","April","May","June","July"];F.map(()=>J.datatype.number({min:0,max:1e3})),F.map(()=>J.datatype.number({min:0,max:1e3}));const T=S(l)(({theme:t})=>({textAlign:"center",borderRadius:t.spacing(1),border:"1px solid rgba(0, 0, 0, 0.12)",boxShadow:"0px 0px 0px 1.5px rgba(0, 0, 0, 0.1)",padding:t.spacing(1),display:"flex",justifyContent:"center",alignItems:"center"}));function _t(){const t=k();v(t.breakpoints.down("xl"));const{map:r}=g();return c.useEffect(()=>{r&&r.attributionControl.setPrefix('Powered by <a href="https://leafletjs.com/" target="_blank">Leaflet</a>')},[r]),e.jsxs(l,{sx:{display:"flex",flexDirection:"column",p:1,justifyContent:"space-between",height:"100%",mt:{xs:0,md:4},fontSize:{xs:"0.65rem",sm:"0.75rem"}},children:[e.jsx(T,{children:e.jsx(Ft,{})}),e.jsx(T,{sx:{height:{md:"45%"},minHeight:240},children:e.jsx(Lt,{})}),e.jsx(T,{children:e.jsx(Et,{})}),e.jsxs(l,{sx:{textAlign:{xs:"center",md:"right"}},children:["Web application byÂ ",e.jsx(C,{href:"https://github.com/chungsarit",target:"_blank",rel:"noopener noreferrer",underline:"hover",children:"CHUNG Sarit"}),"Â (last updated, August 2023)",e.jsx($t,{})]})]})}const Bt=Ne({transitions:{duration:{enteringScreen:0,leavingScreen:250}},palette:{primary:{main:"#0061ff"}},components:{MuiTooltip:{styleOverrides:{tooltip:{}}}}});function Rt(){const{data:t,isLoading:r,error:s}=dt();if(r)return e.jsx(lt,{});if(s)throw s;return e.jsx(Ke,{theme:Bt,children:e.jsx(l,{className:"App",sx:{display:"flex",height:"100vh",width:"100vw"},children:t&&e.jsx(ot,{children:e.jsx(mt,{children:e.jsx(Pt,{contentChildren:e.jsx(St,{eeImageUrls:t}),drawerChildren:e.jsx(_t,{})})})})})})}xe.createRoot(document.getElementById("root")).render(e.jsx(X.StrictMode,{children:e.jsx(Rt,{})}));
